<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Hourly RFI Form</title>
<style>
:root{--bg:#f4f4f5;--card:#ffffff;--text:#18181b;--muted:#52525b;--border:#d4d4d8;--shadow:0 14px 40px rgba(24,24,27,.18);--primary:#27272a;--primaryHover:#18181b;--danger:#dc2626;--radius:18px;--theadBg:#f4f4f5;--rowAlt:#fafafa}
*{box-sizing:border-box}
body{margin:0;font-family:ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial;background:radial-gradient(1100px 420px at 50% -120px,rgba(229,231,235,.9) 0%,var(--bg) 55%,var(--bg) 100%);color:var(--text);padding:28px 18px 44px}
.container{max-width:980px;margin:0 auto}
.header{background:linear-gradient(180deg,#27272a 0%,#09090b 100%);color:#fff;border-radius:18px;padding:22px 20px;box-shadow:var(--shadow);display:flex;justify-content:space-between;flex-wrap:wrap}
.header h1{margin:0;font-size:22px;text-transform:uppercase}
.card{background:#fff;border:1px solid var(--border);border-radius:18px;padding:18px;box-shadow:var(--shadow);margin-top:16px}
label{display:block;font-size:12px;text-transform:uppercase;color:var(--muted);font-weight:800;margin-bottom:6px}
input,select{width:100%;height:44px;padding:10px 12px;border-radius:14px;border:1px solid var(--border)}
input[readonly]{background:var(--theadBg);font-weight:800}
.grid{display:grid;gap:14px}
@media(min-width:780px){.grid.two{grid-template-columns:1fr 1fr}}
.actions{display:flex;gap:10px;margin-top:14px;flex-wrap:wrap}
button{height:44px;padding:0 14px;border-radius:14px;border:1px solid var(--border);background:#fff;font-weight:900;cursor:pointer}
.btn-primary{background:var(--primary);color:#fff;border:none}
.btn-danger{color:var(--danger)}
table{width:100%;border-collapse:separate;border-spacing:0;border:1px solid var(--border);border-radius:14px;overflow:hidden}
thead th{background:var(--theadBg);padding:12px;text-transform:uppercase;font-size:12px}
tbody td{padding:12px;text-align:center;font-weight:650;border-bottom:1px solid var(--border)}
.modal-backdrop{position:fixed;inset:0;background:rgba(0,0,0,.55);display:none;align-items:center;justify-content:center}
.modal-backdrop.show{display:flex}
.modal{background:#fff;border-radius:18px;padding:20px;width:100%;max-width:420px;text-align:center}
</style>
</head>
<body>
<div class="container">
<div class="header"><h1>Request for Information – Hourly Data</h1></div>

<div class="card">
<div class="grid two">
<div><label>Name</label><input id="submittedBy" required></div>
<div><label>Company</label><input id="companyName" required></div>
</div>
</div>

<div class="card">
<div class="grid two">
<div><label>Project Name</label><input id="projectName" required></div>
<div><label>Task Description</label><input id="taskDescription" required></div>
<div><label>Date</label><input type="date" id="date"></div>
<div><label>Manpower</label><select id="manpower"></select></div>
<div><label>Hours Per Person</label><select id="hoursPerPerson"></select></div>
<div><label>Total Hours</label><input id="totalHours" readonly></div>
</div>
<div class="actions">
<button class="btn-primary" onclick="addData()">Enter Data</button>
<button onclick="addMore()">Add More</button>
<button class="btn-primary" onclick="sendEmail()">Send</button>
</div>
</div>

<div class="card">
<table id="dataTable">
<thead><tr><th>Date</th><th>Manpower</th><th>Hours Per Person</th><th>Total Hours</th></tr></thead>
<tbody></tbody>
</table>
</div>

<div class="modal-backdrop" id="successModal">
<div class="modal">
<h3>Info Submitted Successfully</h3>
<p>Would you like to add another project?</p>
<button class="btn-primary" onclick="location.reload()">Yes</button>
<button class="btn-danger" onclick="location.reload()">No I'm Done</button>
</div>
</div>
</div>

<script>
const EMAILJS_PUBLIC_KEY='Y23YPza-d8mge42dV';
const EMAILJS_SERVICE_ID='service_ryus53s';
const EMAILJS_TEMPLATE_ID='template_ezt4v6o';

const manpowerSelect=document.getElementById('manpower');
const hppSelect=document.getElementById('hoursPerPerson');

function addOption(sel,v){const o=document.createElement('option');o.value=v;o.textContent=v;sel.appendChild(o)}

function setupExpandable(select){for(let i=1;i<=50;i++)addOption(select,i);const more=document.createElement('option');more.value='MORE';more.textContent='MORE…';select.appendChild(more);
select.onchange=()=>{if(select.value==='MORE'){const n=prompt('Enter number');if(!n||n<1)return;addOption(select,n);select.value=n;}computeTotal();}}

setupExpandable(manpowerSelect);setupExpandable(hppSelect);

function computeTotal(){const t=manpowerSelect.value*hppSelect.value;document.getElementById('totalHours').value=t||''}

function formatDate(iso){const p=iso.split('-');return p[1]+'-'+p[2]+'-'+p[0]}
function formatHours(v){return v==1?`${v} HOUR`:`${v} HOURS`}

function addData(){
const d=document.getElementById('date').value;
const mp=manpowerSelect.value;
const hpp=hppSelect.value;
if(!d||!mp||!hpp)return alert('Complete all');
const tbody=document.querySelector('#dataTable tbody');
if([...tbody.children].some(r=>r.dataset.iso===d))return alert('Duplicate date');
const tr=document.createElement('tr');
tr.dataset.iso=d;
tr.innerHTML=`<td>${formatDate(d)}</td><td>${mp}</td><td>${formatHours(hpp)}</td><td>${formatHours(mp*hpp)}</td>`;
tbody.appendChild(tr);
}

function addMore(){addData();document.getElementById('date').value='';manpowerSelect.selectedIndex=0;hppSelect.selectedIndex=0;document.getElementById('totalHours').value=''}

function buildEmailText(){let txt='DATE | MANPOWER | HOURS PER PERSON | TOTAL HOURS\n';document.querySelectorAll('#dataTable tbody tr').forEach(r=>{const c=r.children;txt+=`${c[0].innerText} | ${c[1].innerText} | ${c[2].innerText} | ${c[3].innerText}\n`});return txt.toUpperCase()}

function buildReportHtml(){return `<div style="font-family:system-ui;text-transform:uppercase">${document.querySelector('#dataTable').outerHTML}</div>`}

function sendEmail(){
const rows=document.querySelectorAll('#dataTable tbody tr');
if(!rows.length)return alert('No data');
const params={subject:'HOURLY RFI SUBMISSION',message:buildEmailText(),html_report:buildReportHtml()};
emailjs.send(EMAILJS_SERVICE_ID,EMAILJS_TEMPLATE_ID,params).then(()=>{document.getElementById('successModal').classList.add('show')});
}

(function(){const s=document.createElement('script');s.src='https://cdn.jsdelivr.net/npm/emailjs-com@3/dist/email.min.js';s.onload=()=>emailjs.init(EMAILJS_PUBLIC_KEY);document.head.appendChild(s)})();
</script>
</body>
</html>
